<div class="dashboard-container">
  <!-- Se√ß√£o de M√©dias -->
  <div class="section">
    <h2 class="section-title">üìä M√©dias das leituras</h2>
    <div class="cards-row">
      <div class="card leitura umidade">
        <i class="bi bi-droplet icon"></i>
        <h3>{{ umidadeMedia }}%</h3>
        <p>Umidade (m√©dia)</p>
        <small *ngIf="umidadeMinima !== undefined && umidadeMaxima !== undefined">
          Min: {{ umidadeMinima }}% ¬∑ Max: {{ umidadeMaxima }}%
        </small>
      </div>
    </div>
  </div>

  <!-- Se√ß√£o de √öltima Leitura -->
  <div class="section" *ngIf="readings.length">
    <h2 class="section-title">üïí √öltima leitura</h2>

    <div class="cards-row">
      <!-- Umidade -->
      <div class="card leitura umidade">
        <i class="bi bi-droplet icon"></i>
        <h3>{{ lastHumidity ?? 'N/A' }}%</h3>
        <p>Umidade (√∫ltima)</p>
        <small *ngIf="lastTimestampIso">Hora: {{ lastTimestampIso | date:'short' }}</small>
      </div>

      <!-- Estado regando -->
      <div class="card leitura" [ngClass]="lastRegando ? 'umidade' : ''">
        <i class="bi" [ngClass]="lastRegando ? 'bi-play-circle' : 'bi-stop-circle' " style="font-size:2.2rem"></i>
        <h3>{{ lastRegando === null ? 'N/A' : (lastRegando ? 'Sim' : 'N√£o') }}</h3>
        <p>Regando agora?</p>
        <small *ngIf="lastRegaDuracaoS !== null">Dura√ß√£o (s): {{ lastRegaDuracaoS }}</small>
      </div>

      <!-- Volume da √∫ltima rega -->
      <div class="card leitura">
        <i class="bi bi-water icon"></i>
        <h3>{{ lastRegaVolumeL !== null ? (lastRegaVolumeL | number:'1.2-3') + ' L' : 'N/A' }}</h3>
        <p>Volume da √∫ltima rega</p>
      </div>

      <!-- Volume total -->
      <div class="card leitura">
        <i class="bi bi-bar-chart-line-fill icon"></i>
        <h3>{{ lastVolumeTotalL !== null ? (lastVolumeTotalL | number:'1.2-3') + ' L' : 'N/A' }}</h3>
        <p>Volume total acumulado</p>
      </div>

      <!-- Metadados do ESP/Gateway -->
      <div class="card leitura">
        <i class="bi bi-wifi icon"></i>
        <h3>{{ lastEspIp ?? 'N/D' }}</h3>
        <p>IP do gateway</p>
        <small *ngIf="lastEspRssi !== null">RSSI: {{ lastEspRssi }}</small>
      </div>
    </div>
  </div>

  <!-- Mensagem quando n√£o houver leituras -->
  <div class="section" *ngIf="!readings.length">
    <h2 class="section-title">‚ÑπÔ∏è Nenhuma leitura dispon√≠vel</h2>
    <p>O sistema ainda n√£o recebeu leituras do gateway. Verifique a conex√£o do ESP8266 e do Arduino.</p>
  </div>
</div>
